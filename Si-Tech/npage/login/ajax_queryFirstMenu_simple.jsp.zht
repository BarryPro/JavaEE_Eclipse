<% /* * 功能: 查询一级菜单 * 版本: v1.0 * 日期: 2009-11-05 * 作者: hujie * 版权: sitech * 修改历史 * 修改日期:2010-04-27      	修改人:liubo      修改目的:部署黑龙江 */%><%@ page contentType="text/html;charset=GBK"%><%@ include file="/npage/include/public_title_ajax.jsp" %><%String workNo = (String)session.getAttribute("workNo");String workName = (String)session.getAttribute("workName");String passWord = (String)session.getAttribute("password");String orgCode = (String)session.getAttribute("orgCode");String regionCode = orgCode.substring(0,2);%><!--取一级栏目--><wtc:service name="sGetWorkDataNew" outnum="9" routerKey="region" routerValue="<%=regionCode%>">  <wtc:param value="<%=workNo%>" />  <wtc:param value="1" />  <wtc:param value="99999" />  <wtc:param value="1" /></wtc:service><wtc:array id="firstMenu" scope="end"/><div id="divRetCode"><%=retCode%></div><div id="divRetMsg"><%=retMsg%></div><%if(retCode.equals("0")){  if(firstMenu!=null){	int lth =firstMenu.length ;	if(firstMenu.length >= 10){		lth = 10;	}%>	<div id="divShowFirstMenu"><%	for(int i=0; i<lth ; i++){%>		<li opcode="<%=firstMenu[i][1]%>" opname="<%=firstMenu[i][2]%>">			<a href="#" class="text"><%=firstMenu[i][2]%></a>		</li><%	 }%>	</div>	<div id="divOtherFirstMenu"><%	if(firstMenu.length >= 10){		for(int i=10; i < firstMenu.length; i++){%>		  <li><a href="#this" onclick=HoverNav("tree","<%=firstMenu[i][1]%>","<%=firstMenu[i][2]%>")><%=firstMenu[i][2]%></a></li><%			}		}%><!-- begin : add by qidp @ 2010-06-24 --><%                              	String encryptUrl = "";    //String url="username="+workNo+"&channelFlag=CRM#"+nowtime[0][0];    //String encryptUrl=getHostE(url);	//System.out.println("----------------------------------------------------------------"); 	//System.out.println("----------------------------------------------------------------"); 	//System.out.println("===加密后url==="+encryptUrl);	//System.out.println("----------------------------------------------------------------"); 	//System.out.println("----------------------------------------------------------------"); %><%	String[] fcode = new String[8];	String[] fdisplay= new String[8];	fcode[0] = "91800";	fcode[1] = "2826";	fcode[2] = "99010";	fcode[3] = "99011";	fcode[4] = "99012";	fcode[5] = "99991";	fcode[6] = "99880";	fcode[7] = "99076";	StringBuffer sql = new StringBuffer();	sql.append("select * FROM (SELECT a.login_no, b.popedom_code                  \n");	sql.append("FROM sLoginRoalRelation a, sRolePdomRelation b, sPopedomCode c,sFuncCodenew d    \n");	sql.append("WHERE a.role_code = b.role_code                                   \n");	sql.append("AND a.login_no = '?'                                              \n");	sql.append("AND b.popedom_code = c.popedom_code                               \n");	sql.append("AND c.reflect_code = d.function_code                              \n");	sql.append("AND d.main_code='1'                                               \n");	sql.append("AND c.reflect_code ='?'                                           \n");	sql.append("UNION ALL                                                         \n");	sql.append("SELECT c.login_no, c.popedom_code                                 \n");	sql.append("FROM sLoginPdomRelation c, sPopedomCode d                         \n");	sql.append("WHERE c.login_no = '?'                                            \n");	sql.append("AND c.popedom_code = d.popedom_code                               \n");	sql.append("AND reflect_code = '?'                                            \n");	sql.append("AND rela_type = '0'                                               \n");	sql.append("MINUS                                                             \n");	sql.append("SELECT c.login_no, c.popedom_code                                 \n");	sql.append("FROM sLoginPdomRelation c, sPopedomCode d                         \n");	sql.append("WHERE c.login_no = '?'                                            \n");	sql.append("AND c.popedom_code = d.popedom_code                               \n");	sql.append("AND d.reflect_code = '?'                                          \n");	sql.append("AND rela_type = '1')                                              \n");for(int i=0;i<fcode.length;i++){%> <wtc:pubselect name="sPubSelect" routerKey="region" routerValue="<%=regionCode%>" outnum="4">		<wtc:sql><%=sql.toString()%></wtc:sql> <wtc:param value="<%=workNo%>"/> <wtc:param value="<%=fcode[i]%>"/> <wtc:param value="<%=workNo%>"/> <wtc:param value="<%=fcode[i]%>"/> <wtc:param value="<%=workNo%>"/> <wtc:param value="<%=fcode[i]%>"/>	</wtc:pubselect>	<wtc:array id="myresult" scope="end" /><%	if(myresult.length>0){		fdisplay[i]="";	}else{		fdisplay[i]="none";	}}%><wtc:service name="sd585Cfm" outnum="6" routerKey="region" 	 routerValue="<%=regionCode%>" retcode="retCode9" retmsg="retMsg9">  <wtc:param value="0" />  <wtc:param value="01" />  <wtc:param value="" />  <wtc:param value="<%=workNo%>" />	<wtc:param value="<%=passWord%>" />	<wtc:param value="" />	<wtc:param value="" /></wtc:service><wtc:array id="orderList" scope="end"/><%	String orderStyle = "none";	String regionInfo = "|";	String areaInfo = "|";	String hallInfo = "|";	String randomStr = "";	System.out.println(" @@@###############################@ " + workName + "|" + retCode9);	if("000000".equals(retCode9)){			if(orderList != null && orderList.length > 0){				orderStyle = "";				for(int iter = 0; iter < orderList[0].length; iter++){					System.out.println(" @@@@ " + orderList[0][iter]);				}				if(orderList[0][2] != null){					regionInfo = orderList[0][2];				}				if(orderList[0][3] != null){					areaInfo = orderList[0][3];				}				if(orderList[0][4] != null){					hallInfo = orderList[0][4];				}				if(orderList[0][5] != null){					randomStr = orderList[0][5];				}			}	}else{		orderStyle = "none";	}%>	<!--生产IP-->	<li class="othersystem" style="display:<%=fdisplay[0]%>"><a href="#" onclick="javascript:window.open('http://10.110.32.120/csp/bsf/index.action')" >知识库6.0</a></li>	<li class="othersystem" style="display:<%=fdisplay[0]%>"><a href="#" onclick="javascript:window.open('http://10.110.0.227/hljyyt/')" >生产信息系统</a></li>	<li class="othersystem" style="display:<%=fdisplay[1]%>"><a href="#" onclick="javascript:window.open('http://10.110.2.242:7001/phone/index.jsp?login_no=<%=workNo%>');">终端管理</a></li>	<li class="othersystem" style="display:<%=fdisplay[2]%>"><a href="#" onclick="javascript:window.open('/AuthSend_vip.jsp?system_code=99010&targeturl=http://10.110.0.100:41000/main1.jsp')">VIP客户管理</a></li>	<li class="othersystem" style="display:<%=fdisplay[3]%>"><a href="#" onclick="javascript:window.open('/AuthSend_vip.jsp?system_code=99011&targeturl=http://10.110.0.100:41000/main1.jsp')">集团客户管理</a></li>	<li class="othersystem" style="display:<%=fdisplay[4]%>"><a href="#" onclick="javascript:window.open('/AuthSend.jsp?system_code=99012&targeturl=http://10.161.1.137:7001/loginCheck1.jsp');">网管</a></li>	<li class="othersystem" style="display:<%=fdisplay[6]%>"><a href="#" onclick="javascript:window.open('http://10.110.32.121/iwflow/login/VerifyLogin?workNo=<%=workNo%>');">客服投诉</a></li>	<li class="othersystem" style="display:<%=fdisplay[7]%>"><a href="#" onclick="javascript:window.open('http://10.110.2.23:7901/LoginServlet?<%=encryptUrl%>')" >计费系统</a></li>	<!-- ningtn 工单电子化 生产测试IP相同 -->	<li class="othersystem" style="display:<%=orderStyle%>"><a href="#" onclick="javascript:window.open('http://10.109.182.247:8089/logincheck.php?workNo=<%=workNo%>&workName=<%=workName%>&regionInfo=<%=regionInfo%>&areaInfo=<%=areaInfo%>&hallInfo=<%=hallInfo%>&checkNo=<%=randomStr%>')">电子工单系统</a></li>	<!--测试	<li class="othersystem" style="display:<%=fdisplay[0]%>"><a href="#" onclick="javascript:window.open('http://10.110.32.120/csp/bsf/index.action')" >知识库6.0</a></li>	<li class="othersystem" style="display:<%=fdisplay[0]%>"><a href="#" onclick="javascript:window.open('http://10.110.0.227/hljyyt/')" >生产信息系统</a></li>	<li class="othersystem" style="display:<%=fdisplay[1]%>"><a href="#" onclick="javascript:window.open('http://10.110.2.241:7001/phone/index.jsp?login_no=<%=workNo%>');">终端管理</a></li>	<li class="othersystem" style="display:<%=fdisplay[2]%>"><a href="#" onclick="javascript:window.open('/AuthSend_vip.jsp?system_code=99010&targeturl=http://10.110.0.206:30010/main1.jsp')">VIP客户管理</a></li>	<li class="othersystem" style="display:<%=fdisplay[3]%>"><a href="#" onclick="javascript:window.open('/AuthSend_vip.jsp?system_code=99011&targeturl=http://10.110.0.206:30010/main1.jsp')">集团客户管理</a></li>	<li class="othersystem" style="display:<%=fdisplay[4]%>"><a href="#" onclick="javascript:window.open('/AuthSend.jsp?system_code=99012&targeturl=http://10.161.1.137:7001/loginCheck1.jsp');">网管</a></li>	<li class="othersystem" style="display:<%=fdisplay[6]%>"><a href="#" onclick="javascript:window.open('http://10.110.32.121/iwflow/login/VerifyLogin?workNo=<%=workNo%>');">客服投诉</a></li>--><!-- end : add by qidp @ 2010-06-24 -->	</div><%	}}%>