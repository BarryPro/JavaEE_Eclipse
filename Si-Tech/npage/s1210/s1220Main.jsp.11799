<%
/********************
 version v2.0
开发商: si-tech
update:liutong@20080918
********************/
%>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<%@ include file="/npage/include/public_title_name.jsp" %>
<%@ page contentType="text/html;charset=GBK"%>

<%@ page import="com.sitech.boss.pub.util.Encrypt"%>


<%
  	/**
  	ArrayList arrSession1 = (ArrayList)session.getAttribute("allArr");
		String[][] temfavStr1=(String[][])arrSession1.get(3);
    String[] favStr1=new String[temfavStr1.length];
    **/

    String[][]  temfavStr1 = (String[][])session.getAttribute("favInfo");
    String[] favStr1=new String[temfavStr1.length];

    String currentTime = new java.text.SimpleDateFormat("yyyy-MM-dd HH:mm:ss").format(new java.util.Date()); //当前时间
    String sim="readonly";

  for(int i=0;i<favStr1.length;i++){
     favStr1[i]=temfavStr1[i][0].trim();

	}
	if(WtcUtil.haveStr(favStr1,"a090")){
		sim="";
		}
 %>

<%
  request.setCharacterEncoding("GBK");
//	Logger logger = Logger.getLogger("sa220Main.jsp");
  String op_name="";
  String op_code = request.getParameter("op_code");
   if(op_code.equals("1220"))
    op_name="换卡变更";
  else if(op_code.equals("1217"))
    op_name="预销恢复";
  else if(op_code.equals("1260"))
    op_name="预拆恢复";

%>
<html>
<head>
<title><%=op_name%></title>
<%
    /**
    SPubCallSvrImpl co=new SPubCallSvrImpl();

    ArrayList arrSession = (ArrayList)session.getAttribute("allArr");
 	String[][] baseInfoSession = (String[][])arrSession.get(0);
    String work_no = baseInfoSession[0][2];
    String loginName = baseInfoSession[0][3];
    String org_code = baseInfoSession[0][16];
    String region_code=org_code.substring(0,2);
    **/
	String opCode= op_code;
	String opName =op_name;
	String work_no =(String)session.getAttribute("workNo");
	String loginName =(String)session.getAttribute("workName");
	String org_code = (String)session.getAttribute("orgCode");

	String region_code = org_code.substring(0,2);



 	//String[][] temfavStr=(String[][])arrSession.get(3);
 	String[][]  temfavStr = (String[][])session.getAttribute("favInfo");
	String[] favStr=new String[temfavStr.length];
	for(int i=0;i<favStr.length;i++)
	  favStr[i]=temfavStr[i][0].trim();
    boolean pwrf=false;
	boolean hfrf=false;
	if(WtcUtil.haveStr(favStr,"a272"))
      pwrf=true;
 	String srv_no=WtcUtil.repNull(request.getParameter("srv_no"));
    String ReqPageName=WtcUtil.repNull(request.getParameter("ReqPageName"));
    String password = request.getParameter("pname");
//	String smCode=request.getParameter("smCode");
 	ArrayList simStatusArr=new ArrayList();

	String [][]initStr=new String[][]{};
	String [][]errStr=new String[][]{};

	ArrayList retArray = new ArrayList();
    //String[][] result = new String[][]{};

	//String [][]simStatusStr=new String[][]{};
	//String [][]springbz=new String[][]{};
 	//-----------获得手续费-------------
	String oriHandFee="0";
	String oriHandFeeFlag="";

     //-----------获得sim卡状态----------
	String sq1="select trim(sim_status),trim(status_name) from sSimStatus where sim_status='2' or sim_status='3' or sim_status = 'B'";

	//simStatusArr=co.sPubSelect("2",sq1,"phone",srv_no);
    //simStatusStr=(String[][])simStatusArr.get(0);
    %>
		<wtc:pubselect name="TlsPubSelCrm" routerKey="phone" routerValue="<%=srv_no%>"  retcode="ret_code" retmsg="ret_message" outnum="2">
				<wtc:sql><%=sq1%></wtc:sql>
				</wtc:pubselect>
		<wtc:array id="simStatusStr" scope="end" />
	<%
	   if(ret_code.equals("0")||ret_code.equals("000000")){
          System.out.println("调用服务sPubSelect in s1220main.jsp 成功@@@@@@@@@@@@@@@@@@@@@@@@@@");
 	      if(simStatusStr.length==0){
 	      	 String forwardURL = "s1220.jsp?ReqPageName=s1220Main&activePhone="+srv_no+"&op_code="+op_code+"&retMsg=2";
 	          /*
	 	      if(!response.isCommitted())
	 	      {
	 	          response.sendRedirect("s1220.jsp?ReqPageName=s1220Main&activePhone="+srv_no+"&op_code="+op_code+"&retMsg=2");
	 	          out.close();
	 	          return;
	 	      }
	 	      */
	 	      request.getRequestDispatcher(forwardURL).forward(request,response);
	 	      return;
 	      }else{

 	      }

 	   }else{
 	         	System.out.println(ret_code+"    ret_code");
 	     		System.out.println(ret_message+"    ret_message");
 			   System.out.println("调用服务sPubSelect in s1220main.jsp  失败@@@@@@@@@@@@@@@@@@@@@@@@@@");
 			   %>
					    <script language='jscript'>
					       rdShowMessageDialog("查询服务sPubSelect调用失败");
					       parent.removeTab(<%=opCode%>);
				       </script>
				<%
 		}

/*	String sq2="select to_char(count(*)) from dSpringCard a,dcustmsg b where a.id_no=b.id_no and b.phone_no=:phoneNo1 and valid_flag='N' and op_code='1442' ";*/

	//simStatusArr=co.sPubSelect("1",sq1,"phone",srv_no);
    //springbz=(String[][])simStatusArr.get(0);
    String [] paraIn = new String[2];
/*    paraIn[0] = sq2;
    paraIn[1]="phoneNo1="+srv_no;*/
    %>

	<%
/*	   if(ret_code1.equals("0")||ret_code1.equals("000000")){
          System.out.println("调用服务sPubSelect in s1220main.jsp 成功@@@@@@@@@@@@@@@@@@@@@@@@@@");
          System.out.println("springbz="+springbz);

 	   }else{
 	         	System.out.println(ret_code1+"    ret_code1");
 	     		System.out.println(ret_message1+"    ret_message1");
 			   System.out.println("调用服务sPubSelect in s1220main.jsp  失败@@@@@@@@@@@@@@@@@@@@@@@@@@");
 			   %>
					    <script language='jscript'>
					       rdShowMessageDialog("查询服务sPubSelect调用失败");
					       parent.removeTab(<%=opCode%>);
				       </script>
				<%
 		}*/
    String sq8="select substr(belong_code,1,2) from dcustmsg where phone_no=:phoneNo2 ";
    paraIn[0] = sq8;
    paraIn[1]="phoneNo2="+srv_no;

    %>
		<wtc:service name="TlsPubSelCrm" routerKey="phone" routerValue="<%=srv_no%>"  retcode="ret_code1" retmsg="ret_message1" outnum="1">
			<wtc:param value="<%=paraIn[0]%>"/>
			<wtc:param value="<%=paraIn[1]%>"/>
		</wtc:service>
		<wtc:array id="belreg" scope="end" />
	<%
	   if(ret_code1.equals("0")||ret_code1.equals("000000")){
          System.out.println("调用服务sPubSelect in s1220main.jsp 成功@@@@@@@@@@@@@@@@@@@@@@@@@@");
         // System.out.println("belreg="+belreg[0][0]);

 	   }else{
 	         	System.out.println(ret_code1+"    ret_code1");
 	     		System.out.println(ret_message1+"    ret_message1");
 			    System.out.println("调用服务sPubSelect in s1220main.jsp  失败@@@@@@@@@@@@@@@@@@@@@@@@@@");
 			   %>
					    <script language='jscript'>
					       rdShowMessageDialog("查询服务sPubSelect调用失败");
					       parent.removeTab(<%=opCode%>);
				       </script>
				<%
 		}
 	/********* 异地换卡，卡费不可输入  sunaj 2091204*******/
	if(!region_code.equals(belreg[0][0]))
	{
		sim="readonly";
	}
   /************liucm add 20081223 增加空中充值标识*****************/

   /***********dujl add at 20100408 for 毛亮的需求 begin******/
   String hlrsql = "SELECT a.hlr_code||'--'||b.hlr_name FROM shlrcode a,shlrcodename b where a.phoneno_head=substr('"+srv_no+"',1,7) and a.region_code='"+belreg[0][0]+"' AND a.hlr_code=b.hlr_code ";

   %>
   		<wtc:pubselect name="TlsPubSelCrm" routerKey="phone" routerValue="<%=srv_no%>"  retcode="ret_code" retmsg="ret_message" outnum="2">
				<wtc:sql><%=hlrsql%></wtc:sql>
				</wtc:pubselect>
		<wtc:array id="hlrcode" scope="end" />
   <%
   /***********dujl add at 20100408 for 毛亮的需求 end********/


    String sq3="select to_char(count(*)) from dagtbasemsg where agt_phone=:phoneNo3 and status='Y' ";

    paraIn[0] = sq3;
    paraIn[1]="phoneNo3="+srv_no;
    %>
		<wtc:service name="TlsPubSelCrm" routerKey="phone" routerValue="<%=srv_no%>"  retcode="ret_code1" retmsg="ret_message1" outnum="1">
			<wtc:param value="<%=paraIn[0]%>"/>
			<wtc:param value="<%=paraIn[1]%>"/>
			</wtc:service>
		<wtc:array id="agtmsgbz" scope="end" />
	<%
	   if(ret_code1.equals("0")||ret_code1.equals("000000")){
          System.out.println("调用服务sPubSelect in s1220main.jsp 成功@@@@@@@@@@@@@@@@@@@@@@@@@@");
         // System.out.println("agtmsgbz="+agtmsgbz[0][0]);

 	   }else{
 	         	System.out.println(ret_code1+"    ret_code1");
 	     		System.out.println(ret_message1+"    ret_message1");
 			   System.out.println("调用服务sPubSelect in s1220main.jsp  失败@@@@@@@@@@@@@@@@@@@@@@@@@@");
 			   %>
					    <script language='jscript'>
					       rdShowMessageDialog("查询服务sPubSelect调用失败");
					       parent.removeTab(<%=opCode%>);
				       </script>
				<%
 		}

 	//------------获得服务器端初始化信息数组-----------
	//SPubCallSvrImpl im1210=new SPubCallSvrImpl();
	int inputNumber = 3;
	String   outputNumber = "30";
/**
	String  inputParsm [] = new String[inputNumber];
	inputParsm[0] = work_no;
	inputParsm[1] = srv_no;
	inputParsm[2] = op_code;
	**/
  	//String [] initBack = im1210.callService("s1220Init",inputParsm,outputNumber,"phone",srv_no);
  //  int retCode = im1210.getErrCode();
  //	String retMsg = im1210.getErrMsg();

  %>
 			<wtc:service name="s1220Init" routerKey="phone" routerValue="<%=srv_no%>"  retcode="ret_code2" retmsg="ret_message2"  outnum="33" >
			<wtc:param value="<%=work_no%>"/>
			<wtc:param value="<%=srv_no%>"/>
			<wtc:param value="<%=op_code%>"/>
			</wtc:service>
			<wtc:array id="initBack" scope="end" />
  <%
 		  if(ret_code2.equals("0")||ret_code2.equals("000000")){
       	   System.out.println("调用服务s1220Init in s1220main.jsp 成功@@@@@@@@@@@@@@@@@@@@@@@@@@");
 	     	}else{
 	         	System.out.println(ret_code2+"    ret_code2");
 	     		System.out.println(ret_message2+"    ret_message2");
 			    System.out.println("调用服务s1220Init in pubSysAccept.jsp 失败@@@@@@@@@@@@@@@@@@@@@@@@@@");
 			    String forwardURL = "s1220.jsp?ReqPageName=s1220Main&activePhone="+srv_no+"&op_code="+op_code+"&retMsg=101&errCode="+ret_code2+"&errMsg="+ret_message2;
 			    /*
 			    if(!response.isCommitted())
	 	      	{
 			    	response.sendRedirect("s1220.jsp?ReqPageName=s1220Main&activePhone="+srv_no+"&op_code="+op_code+"&retMsg=101&errCode="+ret_code2+"&errMsg="+ret_message2);
 			    	out.close();
 			    	return;
 			    }
 			    */
 			    request.getRequestDispatcher(forwardURL).forward(request,response);
 			    System.out.println("22调用服务s1220InitEx in pubSysAccept.jsp 失败@@@@@@@@@@@@@@@@@@@@@@@@@@");
 			    return;
 			}
/********************** add by dujl at 20090724 start ********************************/
 		if(initBack[0][30].equals("99"))
  		{
%>
  			<script language="javascript">
  				rdShowMessageDialog("平台内部错误,请等平台故障恢复后在继续交易!");
  				removeCurrentTab();
  			</script>
<%
  		}
  		else if(initBack[0][30].equals("00"))
		{
%>
  			<script language="javascript">
  				var	prtFlag = rdShowConfirmDialog("取消现场脱机支付功能还是继续换卡?");
  				if(prtFlag==1)
  				{

  				}
  				else
  				{
  					removeCurrentTab();
  				}
  			</script>
<%
  		}
/********************** add by dujl at 20090724 end   ********************************/


	//------------获取当前主资费名称，所需信息----------
	//SPubCallSvrImpl im1220=new SPubCallSvrImpl();
	int inputNo = 4;
	String   outputNo = "31";
	/**
	String  inParsm [] = new String[inputNo];
	inParsm[0] = work_no;
	inParsm[1] = srv_no;
	inParsm[2] = op_code;
	inParsm[3] = password;
  	String [] initBack1 = im1220.callService("s1270GetMsgView",inParsm,outputNo,"phone",srv_no);
  	**/
  	  %>
 			<wtc:service name="s1270GetMsg" routerKey="phone" routerValue="<%=srv_no%>"  retcode="ret_code3" retmsg="ret_message3"  outnum="32" >
 			<wtc:param value=""/>
 			<wtc:param value="01"/>
			<wtc:param value="<%=op_code%>"/>
			<wtc:param value="<%=work_no%>"/>
			<wtc:param value=""/>
			<wtc:param value="<%=srv_no%>"/>
			<wtc:param value=""/>
			</wtc:service>
			<wtc:array id="initBack1" scope="end" />
    <%
 		  if(ret_code3.equals("0")||ret_code3.equals("000000")){
       	   System.out.println("调用服务s1270GetMsg in s1220main.jsp 成功@@@@@@@@@@@@@@@@@@@@@@@@@@");
/*			System.out.println("springbz[0][0]="+springbz[0][0]);*/

 	     	}else{
 	         	System.out.println(ret_code3+"    ret_code3");
 	     		System.out.println(ret_message3+"    ret_message3");
 			    System.out.println("调用服务s1270GetMsg in  s1220main.jsp  失败@@@@@@@@@@@@@@@@@@@@@@@@@@");
 			    if(!response.isCommitted())
	 	      	{
	 	      	/*begin huangrong 修改转向s1220.jsp错误信息 2010-11-1 10:41*/
 			    	response.sendRedirect("s1220.jsp?ReqPageName=s1220Main&activePhone="+srv_no+"&op_code="+op_code+"&retMsg=101&errCode="+ret_code3+"&errMsg="+ret_message3);
 			    	/*end huangrong 修改转向s1220.jsp错误信息 2010-11-1 10:41*/
 			    	out.close();
 			    	return;
 			    }
 			}



	String[] twoFlag= new String[2];
	twoFlag[0] = "0";
	twoFlag[1] = "0";

	String existPhoneNo="";

%>
<%
	/* ningtn 号簿管家需求 */
	String loginNo =(String)session.getAttribute("workNo");
	String workNoPsw = (String)session.getAttribute("password");
	String[] paraAray4 = new String[7];
	paraAray4[0] = initBack[0][28].trim();
	paraAray4[1] = "01";
	paraAray4[2] = opCode;
	paraAray4[3] = loginNo;
	paraAray4[4] = workNoPsw;
	paraAray4[5] = srv_no;
	paraAray4[6] = "";
	String showText = "";
%>
	<wtc:service name="sAdTermQry" routerKey="regionCode" routerValue="<%=region_code%>"
				 retcode="retCode4" retmsg="retMsg4"  outnum="3" >
		<wtc:param value="<%=paraAray4[0]%>"/>
		<wtc:param value="<%=paraAray4[1]%>"/>
		<wtc:param value="<%=paraAray4[2]%>"/>
		<wtc:param value="<%=paraAray4[3]%>"/>
		<wtc:param value="<%=paraAray4[4]%>"/>
		<wtc:param value="<%=paraAray4[5]%>"/>
		<wtc:param value="<%=paraAray4[6]%>"/>
	</wtc:service>
	<wtc:array id="result4" scope="end" />
<%
	if("000000".equals(retCode4)){
		System.out.println("~~~~调用sAdTermQry成功~~~~");
		if(result4 != null && result4.length > 0){
			showText = result4[0][2];
		}
	}else{
		System.out.println("~~~~调用sAdTermQry失败~~~~");
%>
			<script language="JavaScript">
				rdShowMessageDialog("错误代码：<%=retCode4%>，错误信息：<%=retMsg4%>");
				history.go(-1);
			</script>
<%
	}
%>

<%
String highmsg=(initBack[0][5]).trim();
String ss="中高端用户";
	int spos=highmsg.indexOf(ss,0);
	%>


<script language=javascript>
if(<%=spos%>>=0){rdShowMessageDialog("该用户是中高端用户！");}

if("<%=agtmsgbz[0][0]%>">"0"){rdShowMessageDialog("该用户是空中充值用户！");}
  core.loadUnit("debug");
  core.loadUnit("rpccore");

  onload=function()
  {
    self.status="";
    document.all.s_oldStatus.focus();
	chgSmCode1220();
  }

function chgcardtype()

{
	document.all.t_newsimf.value="";
    	document.all.simType.value="";
    	document.all.cardcard.value="";

	 if(document.all.cardtype[1].checked==true)  //空卡
  	{
  		 var phone = (document.all.srv_no.value).trim();
  		document.all.cardtype_bz.value="k";
  		  		 /****新增调大唐功能取SIM卡类型****/
  		 path ="http://10.110.0.125:33000/writecard/writecard/ReadCardInfo.jsp";
  		 var retInfo1 = window.showModalDialog("Trans.html",path,"","dialogWidth:10;dialogHeight:10;");
		 if(typeof(retInfo1) == "undefined")
    	 {
    		 rdShowMessageDialog("读卡类型出错!");
    		return false;
    	 }

    	var chPos;
    	chPosn = retInfo1.indexOf("&");
    	if(chPosn < 0)
    	{
    		rdShowMessageDialog("读卡类型出错!");
    		return false ;
    	}
   		//alert( retInfo1.substring(0,chPos));
    	retInfo1=retInfo1+"&";
    	var retVal=new Array();
    	for(i=0;i<4;i++)
    	{

    		var chPos = retInfo1.indexOf("&");
        	valueStr = retInfo1.substring(0,chPos);
        	var chPos1 = valueStr.indexOf("=");
        	valueStr1 = valueStr.substring(chPos1+1);
        	retInfo1 = retInfo1.substring(chPos+1);
        	retVal[i]=valueStr1;
        	//alert(valueStr);

    	}
    	//alert("retVal[0]"+retVal[0]);
    	if(retVal[0]=="0")
    	{

    		var rescode_str=retVal[2]+"|";

    		//alert("rescode_str"+rescode_str);
    		var rescode_strstr="";
    		//alert("rescode_str="+rescode_str)
    		var chPosm = rescode_str.indexOf("|");
    		for(i=0;i<4;i++)
    		{

    			var chPos1 = rescode_str.indexOf("|");
        		valueStr = rescode_str.substring(0,chPos1);
        		rescode_str = rescode_str.substring(chPos1+1);
        		//alert("rescode_str="+rescode_str)
        		if(i==0 && valueStr=="")
        		{
        			rdShowMessageDialog("读卡类型出错!");
    		 		return false;
        		}
        		//alert("valueStr="+valueStr);
        		if(valueStr!=""){
        			rescode_strstr=rescode_strstr+"'"+valueStr+"'"+",";
        			//alert("rescode_strstr="+rescode_strstr);
        		}

    		}
    		rescode_strstr=rescode_strstr.substring(0,rescode_strstr.length-1);
    		if(rescode_strstr=="")
    		{
    			rdShowMessageDialog("读卡类型出错!");
    		 	return false;
    		}
  			 //alert("rescode_strstr="+rescode_strstr);
  		}
  		else{
  			 rdShowMessageDialog("读卡类型出错!");
    		 return false;
    	}
  		 /****取SIM卡类型结束******/
    		 var path = "/npage/innet/fgetsimno_1104.jsp";
    		 path = path + "?regioncode=" + "<%=belreg[0][0]%>";
    	         path = path + "&phone=" + phone + "&rescode=" + rescode_strstr+ "&pageTitle=" + "生成SIM卡号码";

    		 var retInfo = window.showModalDialog(path,"","dialogWidth:40;dialogHeight:20;");

    		 if(typeof(retInfo) == "undefined")
    			{	return false;   }

    		var simsim=oneTok(oneTok(retInfo,"~",1));
    		var typetype=oneTok(oneTok(retInfo,"~",2));
    		var cardcard=oneTok(oneTok(retInfo,"~",3));


    		document.all.t_newsimf.value=simsim;
    		document.all.simType.value=typetype;
    		document.all.cardcard.value=cardcard;



  	}else{
  		document.all.b_write.disabled=true;
  		document.all.cardtype_bz.value="s";
  	}

}
function writechg(){
	if(document.all.t_newsimf.value==""){
		rdShowMessageDialog("新sim卡号不能是空!");
		return false;
	}
	if(document.all.cardtype_bz.value=="k"){
		var phone = (document.all.srv_no.value).trim();
  			document.all.b_write.disabled=true;
    		 var path = "/npage/innet/fwritecard.jsp";
    		 path = path + "?regioncode=" + "<%=region_code%>";
    		 path = path + "&sim_type=" +document.all.cardcard.value;
    		 path = path + "&sim_no=" +document.all.t_newsimf.value;
    		 path = path + "&op_code=" +"1220";
    	         path = path + "&phone=" + phone + "&pageTitle=" + "写卡";

    		 var retInfo = window.showModalDialog(path,"","dialogWidth:40;dialogHeight:20;");
    		  if(typeof(retInfo) == "undefined")
    			{	rdShowMessageDialog("写卡失败");
    				//document.all.b_write.disabled=false;
    				document.all.writecardbz.value="1";
    				return false;   }
    		 //rdShowMessageDialog("ssssssssssss");
    		 var retsimcode=oneTok(oneTok(retInfo,"|",1));
    		 var retsimno=oneTok(oneTok(retInfo,"|",2))
    		 var cardstatus=oneTok(oneTok(retInfo,"|",3))
    		 var cardNO=oneTok(oneTok(retInfo,"|",4));
    		 alert("cardNO="+cardNO);
    		  if(retsimcode=="0"){rdShowMessageDialog("写卡成功");
    		 document.all.writecardbz.value="0";
    		 document.all.t_newsimf.value=retsimno;
    		  	document.all.cardstatus.value=cardstatus;
    		  	document.all.cardNO.value=cardNO;  /****add by sungq******/

    		  	if(cardstatus=="3"){document.all.t_simFeef.value="0";}
    		 }else{rdShowMessageDialog("写卡失败");
    		 	//document.all.b_write.disabled=false;
    		 	document.all.writecardbz.value="1";
    		 }
		// rdShowMessageDialog(document.all.writecardbz.value);

	}
	else{
		rdShowMessageDialog("实卡不能写卡");
		document.all.b_write.disabled=true;
		return false;
	}
}
//----------------验证及提交函数-----------------
function printCommit()
{
	getAfterPrompt();
	// in here form check
	// begin huangrong add 验证sim卡费不能为空
	if((document.all.t_simFeef.value.trim().length==0)){
		 	rdShowMessageDialog("sim卡费不能为空!");
		 	return false;
 	}
 	// end huangrong add 验证sim卡费不能为空
	 if((document.all.writecardbz.value!="0") && (document.all.cardtype_bz.value=="k")){
 	rdShowMessageDialog("写卡未成功不能确认!");
 	return false;

 }
	showPrtDlg("Detail","确实要进行电子免填单打印吗？","Yes");
}

 function showPrtDlg(printType,DlgMessage,submitCfm)
 {
	 if((document.all.assuId.value).trim().length>0)
	 {
        if(document.all.assuId.value.length<5)
		{
          rdShowMessageDialog("证件号码长度有误(至少5位)！");
	      document.all.assuId.focus();
		}
	 }

     if(check(frm))
     {
		document.all.t_sys_remark.value="用户"+"<%=initBack[0][1].trim()%>"+"<%=op_name%>";

		 if((document.all.t_op_remark.value).trim().length==0)
      {
			  document.all.t_op_remark.value="操作员<%=work_no%>"+"对用户"+"<%=initBack[0][1].trim()%>"+"进行 "+"<%=op_name%>"

	  }
	  document.all.t_op_remark.value="操作员<%=work_no%>"+"对用户"+"<%=initBack[0][1].trim()%>"+"进行 "+"<%=op_name%>"
	   if((document.all.assuNote.value).trim().length==0)
      {
			  document.all.assuNote.value="操作员<%=work_no%>"+"对用户"+"<%=initBack[0][1].trim()%>"+"进行"+"<%=op_name%>"

	  }

		//显示打印对话框
		var h=210;
		var w=400;
		var t=screen.availHeight/2-h/2;
		var l=screen.availWidth/2-w/2;
		var pType="subprint";
		var billType="1";
		var printStr = printInfo(printType);

		var mode_code=null;
		var fav_code=null;
		var area_code=null;
		var sysAccept = "<%=initBack[0][28].trim()%>";
		/* ningtn */
		var iccidInfoStr = $("#firstId").val() + "|" + $("#secondId").val();	
		var accInfoStr = $("#accInfoHid1").val() + "|" +$("#accInfoHid2").val()+ "|" +$("#accInfoHid3").val()+ "|" +$("#accInfoHid4").val();
		/* ningtn */
		var prop="dialogHeight:"+h+"px; dialogWidth:"+w+"px; dialogLeft:"+l+"px; dialogTop:"+t+"px;toolbar:no; menubar:no; scrollbars:yes; resizable:no;location:no;status:no;help:no"
		var path = "<%=request.getContextPath()%>/npage/innet/hljBillPrint_jc_hw.jsp?DlgMsg=" + DlgMessage+ "&iccidInfo=" + iccidInfoStr + "&accInfoStr="+accInfoStr;
		var path = path  + "&mode_code="+mode_code+"&fav_code="+fav_code+"&area_code="+area_code+"&opCode=<%=op_code%>&sysAccept="+sysAccept+"&phoneNo=<%=srv_no%>&submitCfm=" + submitCfm+"&pType="+pType+"&billType="+billType+ "&printInfo=" + printStr;
		var ret=window.showModalDialog(path,printStr,prop);

		if(typeof(ret)!="undefined")
		{
			if((ret=="confirm")&&(submitCfm == "Yes"))
			{
				if(rdShowConfirmDialog('确认电子免填单吗？')==1)
				{
					conf();
				}
			}
			if(ret=="continueSub")
			{
				if(rdShowConfirmDialog('确认要提交<%=op_name%>信息吗？')==1)
				{
					 conf();
				}
			}
		}
		else
		{
			if(rdShowConfirmDialog('确认要提交<%=op_name%>信息吗？')==1)
			{
				conf();
			}
		}
	 }
 }

function printInfo(printType)
{
  var retInfo = "";
	var cust_info="";
	var opr_info="";
	var note_info1="";
	var note_info2="";
	var note_info3="";
	var note_info4="";

	cust_info+="手机号码："+document.all.srv_no.value+"|";
	cust_info+="客户姓名："+document.all.cus_name.value+"|";
	cust_info+="客户地址："+document.all.cus_addr.value+"|";
	cust_info+="证件号码："+document.all.icc_no.value+"|";

	opr_info+="用户品牌："+"<%=initBack[0][29].trim()%>"+"  办理业务:换卡变更"+"|";
	opr_info+="操作流水："+"<%=initBack[0][28].trim()%>"+"  SIM卡费："+parseFloat(document.all.t_simFeef.value)+"|";
	opr_info+="原SIM卡号："+"<%=initBack[0][9].trim()%>"+"  原SIM卡类型"+"<%=initBack[0][10].trim()%>"+"|";
	opr_info+="新SIM卡号："+document.all.t_newsimf.value+"  新SIM卡类型"+document.all.simType.value+"|";

	note_info1="备注："+"|";
	//retInfo = cust_info+"#"+opr_info+"#"+note_info1+"#"+note_info2+"#"+note_info3+"#"+note_info4+"#";
	retInfo = strcat(cust_info,opr_info,note_info1,note_info2,note_info3,note_info4);
	retInfo=retInfo.replace(new RegExp("#","gm"),"%23");

	//retInfo+="哈尔滨地区用户自SIM卡售出日起30天内，由于非人为原因引起的SIM卡损坏或因机卡配合"+"|";
	//retInfo+="引起的SIM无法使用，我公司可为您免费补卡。"+"|";
    return retInfo;
}

 //--------3---------验证按钮专用函数-------------
 function chkSim(phoneNo,simOldNo,simNewNo)
 {
	if((document.all.t_newsimf.value).trim().length==0)
	{
      rdShowMessageDialog("新SIM卡号不能为空！");
	  document.all.t_newsimf.value="";
	  document.all.t_newsimf.focus();
	  return false;
	}

  	var myPacket = new AJAXPacket("chgSim1220.jsp","正在验证新SIM卡号，请稍候......");
	myPacket.data.add("phoneNo",phoneNo);
	myPacket.data.add("simOldNo",simOldNo);
	myPacket.data.add("simNewNo",simNewNo);
	myPacket.data.add("orgCode", document.all.orgCode.value);
	myPacket.data.add("cardsim_type",document.all.cardcard.value);
	var cardtype="";
	if(document.all.cardtype[1].checked==true){
		document.all.cardtype_bz.value="k";
		cardtype="k";}
	else{	document.all.cardtype_bz.value="s";
		cardtype="s";
	}

	myPacket.data.add("cardtype",cardtype);

	core.ajax.sendPacket(myPacket);
	myPacket=null;
 }

 //--------3---------验证按钮专用函数-------------
 function chgSmCode1220()
 {
    if("<%=op_code%>"=="1220")
    {
		if((document.all.srv_no.value).trim().length==0)
		{
		  return true;
		}
		else
		{
		  if(document.all.srv_no.value.length!=11) return false;
		}

		var myPacket = new AJAXPacket("chSmCode1220_rpc.jsp","正在获得业务品牌，请稍候......");
		myPacket.data.add("srv_no",(document.all.srv_no.value).trim());
		myPacket.data.add("verifyType","smcode");
		core.ajax.sendPacket(myPacket);
		myPacket=null;
    }
	else
    {
		if(frm.cus_pass.disabled){frm.qryPage.focus();}else{frm.cus_pass.focus();}
	}
 }

 function doProcess(packet)
 {
	var verifyType = packet.data.findValueByName("verifyType");

	if(verifyType == "smcode" )
	{
		var smCode=packet.data.findValueByName("smCode");
 		document.getElementById("smCodeDiv").innerHTML = smCode;
	}
    else
	{
		var errCode=packet.data.findValueByName("errCode");
		var errMsg=packet.data.findValueByName("errMsg");
		var simFee=packet.data.findValueByName("simFee");
		var simType=packet.data.findValueByName("simType");
		self.status="";

		if(parseInt(errCode)!=0)
		{
		  //rdShowMessageDialog("SIM卡验证错误！");
		  rdShowMessageDialog("错误"+errCode+"："+errMsg);
		  document.all.t_newsimf.value="";
		  document.all.t_newsimf.focus();
		}
		else
		{
		  document.all.t_simFeef.value=(simFee).trim();
		  document.all.simType.value=(simType).trim();
		  document.all.oriSimFee.value=(simFee).trim();
		  if((document.all.t_simFeef.value).trim().length==0)
		  document.all.t_simFeef.value="0.00";
		  if((document.all.simType.value).trim().length=="")
		  document.all.simType.value="";
		  if((document.all.oriSimFee.value).trim().length==0)
		  document.all.oriSimFee.value="0.00";
		  document.all.t_simFeef.focus();
		  document.all.t_simFeef.select();

		  document.all.b_print.disabled=false;

		  if(document.all.cardtype_bz.value=='k'){
			  document.all.b_write.disabled=false;

		  }
		  document.all.t_newsimf.disabled=true;
		}
	}
 }

 function conf()
 {
   frm.action="s1220_conf.jsp";
   document.all.t_newsimf.disabled=false;
   frm.submit();
 }

 //-------6--------实收栏专用函数----------------
function ChkHandFee()
 {
   if((document.all.oriHandFee.value).trim().length>=1 && (document.all.t_handFee.value).trim().length>=1)
   {
	 if(parseFloat(document.all.oriHandFee.value)<parseFloat(document.all.t_handFee.value))
	 {
	   rdShowMessageDialog("实收手续费不能大于原始手续费！");
	   document.all.t_handFee.value=document.all.oriHandFee.value;
	   document.all.t_handFee.select();
	   document.all.t_handFee.focus();
	   return;
	 }
   }

   if((document.all.oriHandFee.value).trim().length>=1 && (document.all.t_handFee.value).trim().length==0)
   {
	 document.all.t_handFee.value="0";
   }
 }
  function ChkSimFee()
 {
   if((document.all.t_simFeef.value).trim().length>=1)
   {
	 if(parseFloat(document.all.oriSimFee.value)<parseFloat(document.all.t_simFeef.value))
	 {
	  rdShowMessageDialog("实收SIM卡费不能大于原始SIM卡费！");
	  document.all.t_simFeef.value=document.all.oriSimFee.value;
	  document.all.t_simFeef.select();
	  document.all.t_simFeef.focus();
	  return;
	 }
   }

   if((document.all.oriSimFee.value).trim().length>=1 && (document.all.t_simFeef.value).trim().length==0)
   {
	 document.all.t_simFeef.value="0";
   }
 }
function getFew()
{
  if(window.event.keyCode==13)
  {
    var fee=document.all.t_handFee
	var simFee = document.all.t_simFeef;
    var fact=document.all.t_factFee;
    var few=document.all.t_fewFee;
    if((fact.value).trim().length==0)
    {
	  rdShowMessageDialog("实收金额不能为空！");
	  fact.value="";
	  fact.focus();
	  return;
    }
    if(parseFloat(fact.value)<parseFloat(fee.value) + parseFloat(simFee.value))
    {
  	  rdShowMessageDialog("实收金额不足！");
	  fact.value="";
	  fact.focus();
	  return;
    }

	var tem1=((parseFloat(fact.value)-parseFloat(fee.value)-parseFloat(simFee.value))*100+0.5).toString();
	var tem2=tem1;
	if(tem1.indexOf(".")!=-1) tem2=tem1.substring(0,tem1.indexOf("."));
    few.value=(tem2/100).toString();
    few.focus();
  }
}
/* ningtn 号簿管家需求 */
	$(document).ready(function(){
		var showtext = "<%=showText%>";
		var showMsgObj = $("#showMsg");
		showMsgObj.hide();
		if(showtext.length > 0){
			showMsgObj.children("div").text(showtext);
			showMsgObj.show();
		}
	});
</script>
</head>
<body  onMouseDown="hideEvent()" onKeyDown="hideEvent()">

<form name="frm" method="POST"  onKeyUp="chgFocus(frm)">

	   <%@ include file="/npage/include/header.jsp" %>
 <!-- /* ningtn 号簿管家需求 */  -->
<div class="title" id="showMsg">
	<div id="title_zi">

	</div>
</div>
					<div class="title">
						<div id="title_zi"><%=opName%></div>
					</div>


  <input type="hidden" name="ReqPageName" id="ReqPageName" value="s1220Main">
  <input type="hidden" name="srv_no" id="srv_no"  value="<%=srv_no%>">
   <input type="hidden" name="cardcard" id="cardcard">
   <input type="hidden" name="cardNO" id="cardNO">
   <input name=writecardbz type=hidden value="">
   <input name="cardstatus" type=hidden value="">
   <input type="hidden" name="cardtype_bz" id="cardtype_bz" value="s">
  <input type="hidden" name="cus_id" id="cus_id" value="<%=initBack[0][1].trim()%>">
  <input type="hidden" name="cus_name" id="cus_name" value="<%=initBack[0][8].trim()%>">
  <input type="hidden" name="oriHandFee" id="oriHandFee" value="<%=oriHandFee.trim()%>">
  <input type="hidden" name="oriSimFee" id="oriSimFee"  value="">
  <input type="hidden" name="simOldNo" id="simOldNo" value="<%=initBack[0][9].trim()%>">
  <input type="hidden" name="op_code" id="op_code" value="<%=op_code%>">
  <input type="hidden" name="icc_no" id="icc_no" value="<%=initBack[0][14].trim()%>">
  <input type="hidden" name="cus_addr" id="cus_addr" value="<%=initBack[0][15].trim()%>">
  <input type="hidden" name="loginAccept" id="loginAccept" value="<%=initBack[0][28]%>">
  <input type="hidden" name="orgCode" id="orgCode" value="<%=org_code%>">
  <%@ include file="../../include/remark.htm" %>

        <table cellspacing="0" >
          <tr>
            <td width="11%" nowrap class="blue">
              <div align="left">大客户标志</div>
            </td>
            <td nowrap width="18%">
              <div align="left"><b><font color="red"><%=twoFlag[0]%></font></b></div>
            </td>
            <td width="11%" nowrap  class="blue">
              <div align="left">集团标志</div>
            </td>
            <td nowrap height="14">
              <div align="left"><%=twoFlag[1]%></div>
            </td>
            <td nowrap  class="blue">
              <div align="left">服务号码</div>
            </td>
            <td nowrap height="14"><%=srv_no.trim()%></td>
          </tr>
          <tr>
            <td width="11%" nowrap  class="blue">
              <div align="left">证件类型</div>
            </td>
            <td nowrap width="18%">
              <div align="left"><%=initBack[0][13].trim()%></div>
            </td>
            <td width="11%" nowrap class="blue">
              <div align="left">证件号码</div>
            </td>
            <td nowrap height="14">
              <div align="left"><%=initBack[0][14].trim()%></div>
            </td>
            <td nowrap  class="blue">
              <div align="left">SIM卡名</div>
            </td>
            <td nowrap height="14"><%=initBack[0][10].trim()%></td>
          </tr>
          <tr>
            <td width="11%" nowrap class="blue">
              <div align="left">用户ID</div>
            </td>
            <td nowrap width="18%">
              <div align="left"><%=initBack[0][1].trim()%></div>
            </td>
            <td nowrap width="11%" class="blue">
              <div align="left">用户名称</div>
            </td>
            <td nowrap width="31%">
              <div align="left"><%=initBack[0][8].trim()%></div>
            </td>
            <td nowrap width="11%" class="blue">
              <div align="left">号码归属hlr</div>
            </td>
            <td nowrap width="18%">
              <!--<div align="left"><%=initBack[0][5].trim()%></div>-->
              <div align="left"><%=hlrcode[0][0]%></div>
            </td>
          </tr>
          <tr>
            <td width="11%" nowrap  class="blue">
              <div align="left">当前预存</div>
            </td>
            <td nowrap width="18%" height="2">
              <div align="left"><%=initBack[0][6].trim()%></div>
            </td>
            <td nowrap width="11%"  class="blue">
              <div align="left">当前欠费</div>
            </td>
            <td nowrap width="31%">
              <div align="left"><%=initBack[0][7].trim()%></div>
            </td>
            <td nowrap width="11%" class="blue">
              <div align="left">当前状态</div>
            </td>
            <td nowrap width="18%">
              <div align="left"><%=initBack[0][3].trim()%></div>
            </td>
          </tr>
		  <tr>
		  	<td nowrap width="11%" class="blue">
              <div align="left">品牌</div>
            </td>
            <td nowrap width="18%">
              <div align="left" id="smCodeDiv"></div>
            </td>

			  <td nowrap width="11%"  class="blue">
							<div align="left">当前主资费</div>
			  </td>
				<td nowrap width="31%" colspan="3">
							<div align="left"><%=initBack1[0][17].trim()%></div>
				</td>

		  </tr>
          <tr>
            <td colspan="6">
              <hr>
            </td>
          </tr>
                <tr style="display:none">
                  <td nowrap width="15%" class="blue">
                    <div align="left">担保人姓名</div>
                  </td>
                  <td nowrap width="19%">
                    <input name=assuName class="button"  value="<%=initBack[0][16].trim()%>">
                  </td>
                  <td nowrap width="15%" class="blue">
                    <div align="left">担保人电话</div>
                  </td>
                  <td nowrap width="18%">
                    <input name=assuPhone class="button"  value="<%=initBack[0][17].trim()%>">
                  </td>
                </tr>
                <tr style="display:none">
                  <td nowrap width="15%" class="blue">
                    <div align="left">担保人证件类型</div>
                  </td>
                  <td nowrap width="18%">
                    <select name="assuIdType" id="assuIdType" index="2">
<%
        //得到输入参数

                String sqlStr ="select trim(ID_TYPE), ID_NAME,ID_NAME from sIdType order by id_type";
                //retArray = co.sPubSelect("3",sqlStr,"phone",srv_no);
                //int recordNum = Integer.parseInt((String)retArray.get(0));
                //result = (String[][])retArray.get(1);
                //result = (String[][])retArray.get(0);
                %>
                		<wtc:pubselect name="sPubSelect" routerKey="phone" routerValue="<%=srv_no%>"  retcode="ret_code" retmsg="ret_message" outnum="3">
						<wtc:sql><%=sqlStr%></wtc:sql>
						</wtc:pubselect>
						<wtc:array id="result" scope="end" />
				  <%


			         if(ret_code.equals("0")||ret_code.equals("000000")){
			          System.out.println("调用服务sPubSelect in s1220Main.jsp 成功@@@@@@@@@@@@@@@@@@@@@@@@@@");
			 	        	if(result.length==0){
			 	            }else{
			 	            	 int recordNum = result.length;
			 	        	      for(int i=0;i<recordNum;i++){
									  if(result[i][0].trim().equals(initBack[0][18].trim()))
					                    out.println("<option class='button' value='" + result[i][0] + "' selected>" + result[i][1] + "</option>");
					 				  else
								       out.println("<option class='button' value='" + result[i][0] + "'>" + result[i][1] + "</option>");
					                }
			 	        	}

			 	     	}else{
			 	         	System.out.println(ret_code+"    ret_code");
			 	     		System.out.println(ret_message+"    ret_message");
			 				System.out.println("调用服务sPubSelect in s1220Main.jsp 失败@@@@@@@@@@@@@@@@@@@@@@@@@@");

			 			}

%>
                    </select>
                  </td>
                  <td nowrap width="15%" class="blue">
                    <div align="left">担保人证件号码</div>
                  </td>
                  <td nowrap width="19%">
                    <input name=assuId class="button"  value="<%=initBack[0][19].trim()%>">
                  </td>
                </tr>
                <tr style="display:none">
                  <td nowrap width="15%" class="blue">
                    <div align="left">担保人证件地址</div>
                  </td>
                  <td nowrap colspan="3">
                    <input name=assuIdAddr class="button"  value="<%=initBack[0][20].trim()%>">
                  </td>
                </tr>
                <tr style="display:none">
                  <td nowrap width="15%" class="blue">
                    <div align="left">担保人联系地址</div>
                  </td>
                  <td nowrap colspan="3">
                    <input name=assuAddr class="button"  value="<%=initBack[0][21].trim()%>">
                  </td>
                </tr>
                <tr style="display:none">
                  <td nowrap width="15%" class="blue">
                    <div align="left">担保人备注信息</div>
                  </td>
                  <td nowrap colspan="3">
                    <input name=assuNote0 class="button"  value="<%=initBack[0][22].trim()%>">
                  </td>
                </tr>
                <tr>
                  <td nowrap width="13%" class="blue">
                    <div align="left">旧卡SIM卡号</div>
                  </td>
                  <td nowrap width="35%">
                    <div align="left"><%=initBack[0][9].trim()%></div>
                  </td>
                  <td nowrap width="10%" class="blue">
                    <div align="left">旧卡状态</div>
                  </td>
                  <td nowrap width="35%" colspan="3">

					 <div align="left">
                      <select name="s_oldStatus" index="7">
                        <%
					  for(int i=0;i<simStatusStr.length;i++)
					  {
						  if(i==0)
						  {
					  %>
                        <option value="<%=simStatusStr[i][0].trim()%>" selected><%=simStatusStr[i][1].trim()%></option>
                        <%
						  }
						  else
						  {
					   %>
                        <option value="<%=simStatusStr[i][0].trim()%>"><%=simStatusStr[i][1].trim()%></option>
                        <%
						  }
					  }
					  %>
                      </select>
                      <font color="red">*</font></div>
                  </td>
                </tr>
                <tr>
                  <td nowrap width="18%" class="blue">
                    <div align="left">新卡SIM卡号</div>
                  </td>
                  <td nowrap width="35%">
                    <div align="left">
                      <input class="button" type="text" name="t_newsimf" id="t_newsimf" size="20" v_minlength=1 v_maxlength=100  v_type=string v_name="新卡SIM卡号" maxlength="20" value="<%=existPhoneNo%>" index="8" onkeyup="if(event.keyCode==13)chkSim((document.all.srv_no.value).trim(),(document.all.simOldNo.value).trim(),(document.all.t_newsimf.value).trim())">
                      <font color="red">*</font>
                      <input  class="b_text" type="button" name="b_tr_normal" value="验证"  onClick="chkSim((document.all.srv_no.value).trim(),(document.all.simOldNo.value).trim(),(document.all.t_newsimf.value).trim())">
                       <input class="b_text" type="button" name="b_write" value="写卡" onmouseup="writechg()" onkeyup="if(event.keyCode==13)writechg()" disabled index="19">
                      <input type="hidden" name="flg_normal" id="flg_normal" value="0">
                    </div>
                  </td>
				  <td nowrap width="19%" colspan="4"> <input type="radio" name="cardtype" value="N" checked onclick="chgcardtype()" index="-4">
                    实卡
                    <input type="radio" name="cardtype"   value="Y" onclick="chgcardtype()" index="-3">
                    空卡</td>

				  </tr>
				  <tr>
                  <td nowrap width="15%" class="blue">
                    <div align="left">SIM卡费</div>
                  </td>
                  <td nowrap width="19%">
                    <div align="left">

                      <input class="button" type="text" name="t_simFeef" id="t_simFeef" size="10" v_minlength=1 v_maxlength=10  v_type=float  v_name="SIM卡费"  maxlength="10" onblur="ChkSimFee()" <%=sim%> index="9"  >



                      <font color="red">*</font></div>
				 </td>
 					<td nowrap width="15%" class="blue">SIM卡类型</td>
				 <td colspan="3">
				 	<input class="button" type="text" name="simType" size="20" index="9" readonly="ture"></td>
                  </td>
                </tr>
          <tr>
            <td nowrap width="16%" class="blue">
              <div align="left">手续费</div>
            </td>
            <td nowrap width="24%">
              <div align="left">
                <input type="text" class="button" name="t_handFee" id="t_handFee" size="16"
	value="<%=(oriHandFee.trim().equals(""))?("0"):(oriHandFee.trim()) %>" v_type=float v_name="手续费" <%if(hfrf){%>readonly<%}%> onblur="ChkHandFee()" index="10">
              </div>
            </td>
            <td nowrap width="10%" class="blue">
              <div align="left">实收</div>
            </td>
            <td nowrap width="16%">
              <div align="left">
                <input type="text" class="button" name="t_factFee" id="t_factFee" size="16" onKeyUp="getFew()" index="11" v_type=float v_name="实收" <%
	                             if(hfrf)
	                             {
							   %>
								   readonly
							  <%
								 }
							   %>
							   >
              </div>
            </td>
            <td nowrap width="10%" class="blue">
              <div align="left">找零</div>
            </td>
            <td nowrap width="24%">
              <div align="left">
                <input type="text" class="button" name="t_fewFee" id="t_fewFee" size="16" readonly>
              </div>
            </td>
          </tr>
          <tr>
            <td nowrap width="16%" class="blue">
              <div align="left">系统备注</div>
            </td>
            <td nowrap colspan="5">
              <div align="left">
                <input type="text" class="button" name="t_sys_remark" id="t_sys_remark" size="60" readonly maxlength=30>
              </div>
            </td>
          </tr>
          <tr style="display:none">
            <td nowrap width="16%" class="blue">
              <div align="left">用户备注</div>
            </td>
            <td nowrap colspan="5">
              <div align="left">
                <input type="text" class="button" name="t_op_remark" id="t_op_remark" size="60"  v_maxlength=60  v_type=string  v_name="用户备注" maxlength=60 >
              </div>
            </td>
          </tr>
          <tr style="display:none">
            <td nowrap width="16%" class="blue">用户备注</td>
            <td nowrap colspan="5">
              <input name=assuNote class="button" v_must=0 v_maxlength=60 v_type="string" v_name="用户备注" maxlength="60" size=60 index="12" value="">
            </td>
          </tr>
        </table>
        <jsp:include page="/npage/public/hwReadCustCard.jsp">
					<jsp:param name="hwAccept" value="<%=initBack[0][28]%>"  />
					<jsp:param name="showBody" value="01"  />
				</jsp:include>
      	<table>
          <tr>
            <td nowrap colspan="6" id = "footer">
              <div align="center">
                <input class="b_foot" type="button" name="b_print" value="确认&打印" onmouseup="printCommit()" onkeyup="if(event.keyCode==13)printCommit()"  index="13" disabled />
                <input class="b_foot" type="button" name="b_clear" value="清除" onClick="frm.reset();" index="14">
                <input class="b_foot" type="button" name="b_back" value="关闭" onClick="parent.removeTab(<%=opCode%>)" index="15">
              </div>
            </td>
          </tr>
        </table>
			<%@ include file="/npage/include/footer.jsp" %>
   </form>
</body>
<%@ include file="/npage/public/hwObject.jsp" %> 
</html>
