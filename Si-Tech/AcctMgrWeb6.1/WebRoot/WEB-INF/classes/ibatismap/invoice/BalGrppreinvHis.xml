<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE sqlMap
    PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"      
    "http://ibatis.apache.org/dtd/sql-map-2.dtd">
    
<sqlMap namespace="bal_grppreinv_his">
	<insert id="insert" parameterClass="Map" >
	 insert into BAL_GRPPREINV_HIS select UNIT_ID,UNIT_NAME,GRP_PHONE_NO,GRP_CONTRACT_NO,LOGIN_ACCEPT,OP_TIME,LOGIN_NO,INV_FEE,STATE,sysdate,#UPDATE_LOGIN_NO#,INV_NO,
       ITEM,MANAGER_NAME,RETURN_DATE from BAL_GRPPREINV_INFO where LOGIN_ACCEPT=#LOGIN_ACCPET#
	</insert>

	<insert id="insertHis" parameterClass="Map">
		INSERT INTO BAL_GRPPREINV_HIS
		(UNIT_ID,
		UNIT_NAME,
		GRP_PHONE_NO,
		GRP_CONTRACT_NO,
		LOGIN_ACCPET,
		OP_TIME,
		LOGIN_NO,
		INV_FEE,
		STATE,
		UPDATE_TIME,
		UPDATE_LOGIN_NO,
		INV_NO,
		ITEMS,
		MANAGER_NAME,
		RETURN_DATE,
		USER_GROUP_ID)
		SELECT UNIT_ID,
		UNIT_NAME,
		GRP_PHONE_NO,
		GRP_CONTRACT_NO,
		LOGIN_ACCEPT,
		OP_TIME,
		LOGIN_NO,
		INV_FEE,
		#STATE_HIS#,
		SYSDATE,
		#LOGIN_NO#,
		INV_NO,
		ITEM,
		MANAGER_NAME,
		RETURN_DATE,
		USER_GROUP_ID
		FROM BAL_GRPPREINV_INFO
		WHERE 1=1
		<dynamic prepend="">
            <isNotEmpty prepend="AND" property="INV_NO">
                INV_NO = #INV_NO#
            </isNotEmpty>

            <isNotEmpty prepend="AND" property="LOGIN_ACCPET">
               LOGIN_ACCEPT = #LOGIN_ACCPET#
            </isNotEmpty>
            
            <isNotEmpty prepend="AND" property="CONTRACT_NO">
               GRP_CONTRACT_NO = #CONTRACT_NO#
            </isNotEmpty>
			
			<isNotEmpty prepend="AND" property="PAY_SN">
               PAY_SN = #PAY_SN#
            </isNotEmpty>
        </dynamic>
	</insert>
	
	
</sqlMap>